!function(){"use strict";const t=t=>({name:"NoRouteFoundForDefaultPath",message:`No route found for the defaultPath: '${t}'`});class e{constructor(n,a,s){this.location=n,this.routes=s;const{matches:i}=e.traverse(a,s);if(0===i.length)throw t(a)}startTracking(t){t.addEventListener("hashchange",({newURL:t})=>{const e=new URL(t).hash.slice(1);this.moveTo(e)})}static traverse(t,n,a=[],s=""){let i=null;if(n.find(e=>{const n=e.match(t);return null!==n&&(i={route:e,result:n},!0)}),null===i)return{path:s,matches:a};const{result:{path:r},route:{children:h}}=i;if(h.length>0){const n=t.substring(r.length);return e.traverse(n,h,[...a,i],s+r)}return{path:s+r,matches:[...a,i]}}moveTo(t){const{path:n,matches:a}=e.traverse(t,this.routes);return this.location.replace(`#${n}`),a.forEach(({route:t,result:{params:e}})=>{t.handler({path:n,params:e})}),n}}class n{constructor(t,e,n=[]){this.paramNames=[];const a=t.split("/").map(t=>t.startsWith(":")?(this.paramNames.push(t.slice(1)),"([^/]+)"):t).join("/");this.pathRegex=new RegExp(`^${a}`),this.handler=e,this.children=n}match(t){const e=this.pathRegex.exec(t);if(null===e)return null;const[n,...a]=e,s=t.charAt(n.length);if(""!==s&&"/"!==s)return null;const i={};return this.paramNames.forEach((t,e)=>{i[t]=a[e]}),{path:n,params:i}}}const a={};var s=(t,e,n)=>{if(!/[a-z][a-z0-9_.-]*-[a-z0-9_.-]*/.test(t))throw(t=>({name:"InvalidViewName",message:`Invalid view name: '${t}'`}))(t);return customElements.define(t,class extends HTMLElement{constructor(){super();const s=this.getAttribute("id")||"";void 0===a[t]&&(a[t]={}),a[t][s]={element:this,fun:n};const{html:i,attachments:r}=n(...e);this.innerHTML=i,Object.entries(r).forEach(([t,e])=>{Object.assign(this.querySelector(t),e)})}}),t};const i=(t,e="")=>(...n)=>{if(void 0===a[t])return;const{element:s,fun:i}=a[t][e],{html:r,attachments:h}=i(...n);s.innerHTML=r,Object.entries(h).forEach(([t,e])=>{Object.assign(s.querySelector(t),e)})},r=(t,e,n)=>`\n  <a href="#/${e}" class="navbar-item${t===e?" active":""}">${n}</a>\n`;var h=s("deadend-navbar",[""],t=>({html:`\n    <nav>\n      <a class="title" href="#">deadend</a>\n      ${r(t,"input","Using input")}\n      ${r(t,"http","Using HTTP")}\n      ${r(t,"tick","Using tick event")}\n      <a class="navbar-item" href="http://github.com/SekiT/deadend">GitHub</a>\n    </nav>\n  `,attachments:{nav:{onclick:()=>i("deadend-navbar")("clicked")}}})),c=s("deadend-home",[],()=>({html:'\n    <h1 class="home-title">deadend</h1>\n    <p>My deadend of frontend</span>\n    <ul>\n      <li><a href="#/input">Using input</a></li>\n      <li><a href="#/http">Using HTTP</a></li>\n      <li><a href="#/tick">Using tick event</a></li>\n    </ul>\n  ',attachments:{}}));const o={value:"",observers:[]};var u=t=>{o.value=t,o.observers.forEach(e=>e(t))},l=()=>o.value,d=t=>{o.observers.push(t)};const m="deadend-near-realtime-output";var p=s(m,[""],t=>({html:`\n    <p>\n      This is updated near-readlitime. Value is: ${t}\n    </p>\n  `,attachments:{}}));(t=>d(e=>i(t)(e)))(m);const v="deadend-on-event-output";var f=s(v,[""],t=>({html:`\n    <p>\n      This is updated when <button class="updater">this button</button> is clicked. Value is: ${t}\n    </p>\n  `,attachments:{"button.updater":{onclick:()=>i(v)(l())}}})),b=s("deadend-input",[],()=>({html:`\n    <h1>Using input</h1>\n    <p>\n      deadend is not reactive. Event listeners call subject.next and observers update the view.\n    </p>\n    <input type="text"><button class="setter">Set random value to the subject</button>\n    <${p}></${p}>\n    <${f}></${f}>\n  `,attachments:{input:{oninput:({target:t})=>u(t.value)},"button.setter":{onclick:()=>u(["deadend","lorem ipsum","quick fox"][new Date%3])}}})),g=s("deadend-http",[],()=>({html:"This is http view",attachments:{}})),w=s("deadend-tick",[],()=>({html:"This is tick view",attachments:{}}));const $={home:c,input:b,http:g,tick:w};var k=s("deadend-route-switch",["home"],t=>{const e=$[t];return{html:`\n      <${e}></${e}>\n    `,attachments:{}}}),T={root:s("deadend-root",[],()=>({html:`\n    <${h}></${h}>\n    <${k}></${k}>\n  `,attachments:{}})),navbar:h,routeSwitch:k,input:b,http:g,tick:w};const{root:E,navbar:U,routeSwitch:x}=T,j=t=>()=>{i(U)(t),i(x)(t)},H=new e(window.location,"",[new n("",({path:t})=>{""===t&&j("home")()},[new n("/input",j("input")),new n("/http",j("http")),new n("/tick",j("tick"))])]);document.getElementById("root").innerHTML=`<${E}></${E}>`,H.moveTo("/bar/baz"),H.startTracking(window)}();
